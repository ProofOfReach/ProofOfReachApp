/**
 * Nostr Ad Marketplace SDK v1.0.0
 * https://nostradmarketplace.com
 * @license MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).NostrAdMarketplaceSDK=t()}(this,function(){"use strict";function e(e,t){void 0===t&&(t={});var r=Object.assign({},t);return r.headers=Object.assign({"Authorization":"Bearer "+this.apiKey,"Content-Type":"application/json"},t.headers||{}),this._log("Fetching "+(t.method||"GET")+" "+e,r),fetch(e,r).then(function(e){return 204===e.status?null:e.json().then(function(t){if(!e.ok)throw new Error(t.message||"API error: "+e.status);return t})}).catch(function(e){throw this._log("API request failed",e),e}.bind(this))}var t=function(t){if(!t||!t.apiKey)throw new Error("API key is required to initialize the SDK");this.apiKey=t.apiKey,this.baseUrl=t.baseUrl||"https://api.nostradmarketplace.com",this.debug=!!t.debug,this.serveAd=this.serveAd.bind(this),this.trackClick=this.trackClick.bind(this),this.fetchPublisherStats=this.fetchPublisherStats.bind(this),this._request=e.bind(this)};return t.prototype._log=function(e,t){this.debug&&console.log("[NostrAdSDK] "+e,t||"")},t.prototype.serveAd=function(e){void 0===e&&(e={});var t=new URLSearchParams;e.placement&&t.append("placement",e.placement),e.pubkey&&t.append("pubkey",e.pubkey),e.format&&t.append("format",e.format),e.interests&&t.append("interests",Array.isArray(e.interests)?e.interests.join(","):e.interests);var r=t.toString(),n="/api/ads/serve"+(r?"?"+r:"");try{return this._request(this.baseUrl+n).catch(function(e){if(e.message&&e.message.includes("204"))return null;throw e})}catch(e){if(e.message&&e.message.includes("204"))return Promise.resolve(null);throw e}},t.prototype.trackClick=function(e){if(!e.adId)throw new Error("adId is required for tracking clicks");var t="/api/ads/"+e.adId+"/click",r={pubkey:e.pubkey,placement:e.placement};return this._request(this.baseUrl+t,{method:"POST",body:JSON.stringify(r)})},t.prototype.fetchPublisherStats=function(e){void 0===e&&(e={});var t=new URLSearchParams;e.startDate&&t.append("startDate",e.startDate),e.endDate&&t.append("endDate",e.endDate);var r=t.toString(),n="/api/publisher/stats"+(r?"?"+r:"");return this._request(this.baseUrl+n)},t});